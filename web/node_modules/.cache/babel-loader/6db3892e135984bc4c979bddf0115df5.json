{"ast":null,"code":"import * as esbuild from \"esbuild-wasm\";\nimport { unpkgPathPlugin } from \"plugins/unpkg-path-plugin\";\nimport { fetchPlugin } from \"plugins/fetch-plugin\";\nlet service;\nexport default async function (code) {\n  if (!service) {\n    service = await esbuild.startService({\n      worker: true,\n      wasmURL: \"https://unpkg.com/esbuild-wasm@0.8.27/esbuild.wasm\"\n    });\n  }\n\n  const result = await service.build({\n    entryPoints: [\"index.js\"],\n    bundle: true,\n    write: false,\n    plugins: [unpkgPathPlugin(), fetchPlugin(code)],\n    define: {\n      \"process.env.NODE_ENV\": '\"production\"',\n      global: \"window\"\n    }\n  });\n  return result.outputFiles[0].text;\n}","map":{"version":3,"sources":["/home/mfahmy/workspace/react/codebook/src/bundler/index.ts"],"names":["esbuild","unpkgPathPlugin","fetchPlugin","service","code","startService","worker","wasmURL","result","build","entryPoints","bundle","write","plugins","define","global","outputFiles","text"],"mappings":"AAAA,OAAO,KAAKA,OAAZ,MAAyB,cAAzB;AACA,SAASC,eAAT,QAAgC,2BAAhC;AACA,SAASC,WAAT,QAA4B,sBAA5B;AAEA,IAAIC,OAAJ;AAEA,eAAe,gBAAeC,IAAf,EAA4B;AACzC,MAAI,CAACD,OAAL,EAAc;AACZA,IAAAA,OAAO,GAAG,MAAMH,OAAO,CAACK,YAAR,CAAqB;AACnCC,MAAAA,MAAM,EAAE,IAD2B;AAEnCC,MAAAA,OAAO,EAAE;AAF0B,KAArB,CAAhB;AAID;;AAED,QAAMC,MAAM,GAAG,MAAML,OAAO,CAACM,KAAR,CAAc;AAC/BC,IAAAA,WAAW,EAAE,CAAC,UAAD,CADkB;AAE/BC,IAAAA,MAAM,EAAE,IAFuB;AAG/BC,IAAAA,KAAK,EAAE,KAHwB;AAI/BC,IAAAA,OAAO,EAAE,CAACZ,eAAe,EAAhB,EAAoBC,WAAW,CAACE,IAAD,CAA/B,CAJsB;AAK/BU,IAAAA,MAAM,EAAE;AACN,8BAAwB,cADlB;AAENC,MAAAA,MAAM,EAAE;AAFF;AALuB,GAAd,CAArB;AAWE,SAAOP,MAAM,CAACQ,WAAP,CAAmB,CAAnB,EAAsBC,IAA7B;AAEH","sourcesContent":["import * as esbuild from \"esbuild-wasm\";\nimport { unpkgPathPlugin } from \"plugins/unpkg-path-plugin\";\nimport { fetchPlugin } from \"plugins/fetch-plugin\";\n\nlet service: esbuild.Service;\n\nexport default async function(code:string) {\n  if (!service) {\n    service = await esbuild.startService({\n      worker: true,\n      wasmURL: \"https://unpkg.com/esbuild-wasm@0.8.27/esbuild.wasm\",\n    });\n  }\n\n  const result = await service.build({\n      entryPoints: [\"index.js\"],\n      bundle: true,\n      write: false,\n      plugins: [unpkgPathPlugin(), fetchPlugin(code)],\n      define: {\n        \"process.env.NODE_ENV\": '\"production\"',\n        global: \"window\",\n      },\n    });\n\n    return result.outputFiles[0].text;\n  \n}"]},"metadata":{},"sourceType":"module"}